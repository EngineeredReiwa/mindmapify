# Mindmapify ユーザー体験設計書

> ✅ **Phase 6対応**: 実装済み機能に基づく最新のUX設計（2024年更新）

## ユーザージャーニー

### メインユースケース：「LLMとの協働思考による論理的思考の深化」

#### 🧠 思考プロセスの本質
**ユーザーの思考パターン**：
1. **発散フェーズ**: ブレインストーミングでアイデアを爆発的に創出
2. **収束フェーズ**: 散らばったアイデアを厳密かつシンプルな論理構造に組織化
3. **共有フェーズ**: 論理構造をLLMが理解可能な形式で即座に出力
4. **協働フェーズ**: LLMとのディスカッションで思考を深化

#### 🎯 解決する課題
- **時間の無駄**: 論理構造の文章化に大量の時間を消費
- **伝達ロス**: 複雑な思考構造の言語化で情報が劣化
- **反復性**: LLMフィードバック後の再構造化作業の煩雑さ

#### 🚀 本アプリの価値提案
**現在の姿（Phase 6）**：
- 思考の発散・収束プロセスを直感的にサポート
- 論理構造をMermaid Flowchartで瞬時にエクスポート
- LLMが即座に理解可能な構造化データを提供

**将来の姿（Phase 7+）**：
- LLMからの修正提案をUIに再インポート
- 思考→LLM→修正→再思考のサイクル高速化
- **キーボードドリブン操作**：物理ブレストスピードへの追従
- **人間の直感的思考 × LLMの論理分析** の完全融合

**コンセプト**: 「Think freely. Export clearly. Iterate deeply. **Move at the speed of thought.**」

### 思考プロセスに沿った実装済みフロー

#### 1. 発散フェーズ：アイデア爆発（0-30秒）
- **思考状態**: 「頭の中にあるアイデアをすべて吐き出したい」
- **操作**: 
  - 空白クリック OR `Cmd+Shift+A` で次々とノード作成
  - 1クリック即編集でアイデアを高速入力
  - 位置は気にせず、思いつくままに配置
- **UI支援**: 
  - 重複回避グリッド自動配置
  - 自動サイズ調整でテキスト量に制限なし
  - 瞬間レスポンス（50ms以内）でフロー中断なし
- **心理状態**: 「考えることに集中できる、UIが邪魔しない」

#### 2. 収束フェーズ：論理構造化（30秒-3分）
- **思考状態**: 「散らばったアイデア間の論理関係を整理したい」
- **操作**:
  - ノードドラッグで概念の階層・関係を空間配置
  - 接続点ドラッグで論理関係を明示的に接続
  - 接続ダブルクリック → 関係性ラベル（8種類）で精密化
  - エンドポイント編集で論理構造の微調整
- **論理パターン**:
  - 「原因→結果」「手段→目的」「要素→全体」
  - 「対比・補完」で多角的分析
  - ループ表現で循環論理も対応
- **心理状態**: 「複雑な思考が整然とした構造に変換される快感」

#### 3. 共有フェーズ：LLM協働準備（3-4分）
- **思考状態**: 「この論理構造をLLMに正確に伝えたい」
- **操作**: 「Copy Mermaid」で構造化データ一発出力
- **出力内容**: 
  ```mermaid
  flowchart TD
      A[根本原因] --> B[問題現象]
      B --> C[解決手段1]
      B --> D[解決手段2]
      C --> E[期待効果]
  ```
- **LLM活用**: 
  - Claude/ChatGPTにペースト → 即座に論理構造を理解
  - 「この構造について分析・改善提案をして」
  - 文章化の時間を90%削減
- **心理状態**: 「思考の精度を保ったままLLMとディスカッションできる」

#### 4. 反復フェーズ：思考深化（将来Phase 7+）
- **思考状態**: 「LLMの提案を取り込んでさらに思考を発展させたい」
- **将来機能**:
  - LLM修正案のMermaidコードを逆インポート
  - UIで視覚的に差分確認・マージ
  - 新たな発散・収束サイクルの開始
- **期待効果**: **人間の直感 × LLMの論理 = 思考の指数的深化**

## インターフェース設計

### 実装済み操作とフィードバック

#### ノード操作
- **作成**: 
  - Add Nodeボタン OR キャンバス空白クリック → 即座にノード出現
  - 自動で編集モード開始 + カーソル表示
- **編集**: 
  - 1クリック → 直接編集開始（ダブルクリック不要）
  - Konva内蔵編集：カーソル移動、文字入力、改行対応
  - 自動リサイズ：テキスト量に応じてノードサイズ動的調整
- **移動**: ドラッグ&ドロップ → 履歴保存、接続線自動追従
- **削除**: 
  - 選択後 `Delete/Backspace` キー
  - ツールバー「Delete」ボタン
  - `Cmd+Shift+D`（安全削除：選択時のみ）

#### 接続操作
- **作成**: 
  - 接続点（4方向常時表示）をドラッグ開始
  - 点線プレビュー：リアルタイム軌道表示
  - 有効接続点でホバー時ハイライト
  - ドロップ成功 → ベジェ曲線接続 + 矢印ヘッド
- **ラベル編集**:
  - 接続線ダブルクリック → 8種類プリセット選択UI
  - 数字キー1-8：クイック選択
  - 「原因」「結果」「手段」「具体例」「要素」「同類」「対比」「補完」
- **エンドポイント編集**:
  - 接続選択 → 緑/赤ハンドル表示
  - ハンドルクリック → 接続編集モード開始
  - 別ノードクリック → エンドポイント変更
- **削除**: 接続選択 + `Delete`キー

#### キャンバス操作
- **スクロール**: マウスホイール（縦横対応）、Shift+ホイール（横スクロール）
- **ズーム**: `Cmd +/-`キー（連続対応）
- **リセット**: `Cmd+0`（ズーム・位置リセット）
- **パン**: キャンバスドラッグ（ノード以外の領域）

### 視覚的フィードバック

#### Apple HIG準拠のデザインシステム
- **キャンバス背景**: `bg-gray-50` Tailwind（#f9fafb）
- **ノード**:
  - 通常: `bg-white` + `border-gray-200` + `shadow-md`
  - 選択: `border-blue-500` + `shadow-lg` + 青色テキスト
  - 編集中: ヒント表示 + カーソル点滅
- **接続線**:
  - 通常: `stroke-gray-500` 2px幅
  - 選択: `stroke-blue-500` 3px幅 + ドロップシャドウ
  - 矢印ヘッド: 三角形、8px、視認性重視
- **接続点**:
  - 開始: `fill-green-500`（#22c55e）
  - 終了: `fill-red-500`（#ef4444）
  - ホバー: スケール1.2倍 + ドロップシャドウ

#### インタラクション・アニメーション
- **ノード作成**: Konvaネイティブ、瞬間表示
- **ドラッグ**: 滑らかな追従、グリッドスナップなし
- **接続描画**: 点線→実線の瞬間切り替え
- **ホバー**: 微細なスケール変化（アクセシビリティ配慮）
- **レスポンス**: 100ms以内の即座フィードバック

### アクセシビリティ配慮

#### 実装済みキーボードショートカット
- **`Cmd+Shift+A`**: 新規ノード追加（可視範囲内に配置）
- **`Cmd+Shift+D`**: 選択アイテム安全削除
- **`Cmd+A`**: 全選択
- **`Cmd+Z/Y`**: Undo/Redo（履歴管理）
- **`Cmd +/-`**: ズームイン/アウト（連続対応）
- **`Cmd+0`**: ズーム・位置リセット
- **`Delete/Backspace`**: 選択削除
- **`Escape`**: 選択解除・編集キャンセル
- **`?`**: ショートカットヘルプ表示

#### 接続ラベル編集ショートカット
- **数字キー1-8**: ラベル編集時のクイック選択
  1. 原因 2. 結果 3. 手段 4. 具体例
  5. 要素 6. 同類 7. 対比 8. 補完

#### アクセシビリティ機能
- **44px以上のタッチターゲット**: モバイル対応
- **十分なコントラスト**: WCAG AA準拠
- **キーボードナビゲーション**: マウス不要操作
- **視覚的フィードバック**: 状態変化の明確表示

## エラーハンドリングとユーザーガイダンス

### 実装済みユーザーガイダンス
- **空キャンバス時**: 中央ヒント「Add Nodeボタンを押してアイデアを追加しましょう」
- **編集時ヒント**: 「Ctrl+Enter: 保存 | Esc: キャンセル | 外クリック: 自動保存」
- **ショートカットヘルプ**: `?`キーで全ショートカット一覧表示
- **操作フィードバック**: 「Copied!」など明確な状態通知

### 堅牢なエラー防止システム
- **完全履歴管理**: 50段階Undo/Redo、全操作対応
- **自動保存機能**: 編集中断時の自動保存
- **安全削除**: `Cmd+Shift+D`による意図的削除のみ
- **接続制御**: 
  - 同一ノード接続防止
  - 重複接続自動回避
  - 無効ドロップ時の視覚的フィードバック
- **状態管理**: Zustand + Immerによる一貫性保証

### パフォーマンス最適化
- **軽量アーキテクチャ**: 173KB（gzipped）、3秒以内初期ロード
- **効率的レンダリング**: Konva最適化、60fps維持
- **メモリ管理**: React.memo、useMemo積極活用
- **レスポンシブ対応**: デスクトップ優先、タブレット対応

## 実測パフォーマンス指標

### ✅ 達成済み技術指標
- **初期ロード**: 実測1-2秒（目標3秒以内）
- **ノード作成**: 実測50ms以内（目標100ms以内）
- **Mermaidコード生成**: 実測100ms以内（目標500ms以内）
- **バンドルサイズ**: 173KB gzipped（軽量化達成）

### ✅ 実測UX指標
- **1クリック編集**: ダブルクリック不要の直感操作実現
- **自動保存**: 編集中断時の完全復旧機能
- **キーボードフロー**: マウス不要の高速操作対応
- **接続精度**: 視覚的明確性とエンドポイント編集機能

## 🎯 現在の開発状況

### ✅ 完了済み（Phase 1-5B）
- **基盤機能**: ノード CRUD、接続システム、Mermaid出力
- **高度な編集**: 1クリック編集、動的リサイズ、Konva直接編集
- **接続機能**: ラベル編集（8種）、エンドポイント変更、視覚的フィードバック
- **ユーザビリティ**: キーボードショートカット、履歴管理、自動保存
- **本番運用**: Vercel本番デプロイ、パフォーマンス最適化

### 🔄 進行中（Phase 6）
- **接続システム精度向上**: より正確な接続点配置
- **UXマイクロ改善**: 細かい操作性向上
- **パフォーマンス調整**: 大規模マインドマップ対応

### 🎯 UX設計達成度
本設計書の全主要機能が実装完了。「Think freely. Export clearly.」のコンセプトを完全実現し、技術的複雑さを隠した直感的な思考整理ツールとして稼働中。

## 🚀 次世代ビジョン：キーボードドリブン思考支援

### 思考スピード追従の哲学
「**デジタルツールは思考速度のボトルネックになってはならない**」

物理的なブレインストーミング（付箋・ホワイトボード）では：
- 新しいアイデア → 瞬時に付箋に書き込み
- 関係性の発見 → 付箋を即座に移動・グルーピング
- 構造の調整 → 空間配置の自由な変更

**Mindmapify Phase 7+のビジョン**：この物理的な思考フローを**キーボードドリブンで完全再現**

### 🎯 目標体験：「思考の瞬間化」

#### 現在の限界
- マウス操作：思考→マウス移動→クリック（認知的切り替えコスト）
- メニュー探し：機能を探すために思考が中断
- 操作待機：UIレスポンス待ちで思考フローが止まる

#### Phase 7+ ビジョン
```
思考 → キーストローク → 瞬間実行
（認知的切り替えコストゼロ）
```

### ⚡ キーボードドリブン操作の未来像

#### 🔥 高速ノード操作
- **新規作成**: `N` → 思考位置に即座にノード出現 + 編集開始
- **複製作成**: `D` → 選択ノードを複製 + 編集開始
- **素早い移動**: `HJKL` or 矢印キー → ノード位置の微調整
- **スナップ移動**: `Shift+矢印` → グリッド単位での整列移動

#### ⚡ 超高速接続操作
- **接続開始**: `C` → 選択ノードから接続モード開始
- **方向指定接続**: `C + 矢印` → 指定方向のノードに直接接続
- **関係性クイック設定**: `C + 数字1-8` → 接続 + ラベル設定を同時実行
- **接続変更**: `R + 矢印` → 既存接続のエンドポイント変更

#### 🎨 空間操作の加速
- **グルーピング**: `G` → 選択ノード群を自動整列配置
- **階層化**: `T` → 選択ノード群を木構造レイアウト
- **クラスタリング**: `Shift+G` → 概念的近接性による自動グルーピング

### 🧠 思考パターンに最適化されたUX

#### 発散思考支援
```
アイデア連鎖: N → テキスト入力 → Tab → N → テキスト入力 → Tab...
（思考の流れを止めない連続ノード作成）
```

#### 収束思考支援
```
関係性探索: C → 矢印ナビゲーション → Enter → ラベル選択
（既存アイデア間の論理関係を高速発見）
```

#### 構造化思考支援
```
階層整理: 複数選択 → T → 自動階層レイアウト
（散らばったアイデアを瞬時に構造化）
```

### 📊 期待される効果

#### 時間効率
- **ノード作成時間**: 3秒 → 0.5秒（6倍高速化）
- **接続作成時間**: 5秒 → 1秒（5倍高速化）
- **構造調整時間**: 30秒 → 5秒（6倍高速化）

#### 認知負荷軽減
- **UIナビゲーション**: ゼロ（キーボードのみ）
- **操作学習コスト**: 最小（直感的キーマッピング）
- **思考中断**: ほぼゼロ（瞬間レスポンス）

#### 創造性向上
- **思考フロー維持**: 中断のない連続思考
- **アイデア密度**: 単位時間あたりのアイデア量増加
- **構造化品質**: 高速試行錯誤による最適構造発見

### 🎭 ユーザー体験の革新

**従来**：「ツールに思考を合わせる」
**Phase 7+**：「ツールが思考に追従する」

キーボードドリブンMindmapifyは、**思考の外部化ツール**から**思考の増幅装置**へと進化する。

ユーザーは思考に集中し、手は自然にキーボードを叩く。画面上では思考構造が瞬時に形成され、LLMとの協働で思考は指数的に深化していく。

**これが次世代の思考支援体験である。**